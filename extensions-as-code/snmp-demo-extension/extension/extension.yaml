# These are mandatory fields for any extension
name: custom:snmp.demo
version: 1.1.0
minDynatraceVersion: "1.231"
author:
  name: "Perform User"
  
# Here is the definition of our SNMP datasource
# We will have three metrics, sys.uptime, interface.in.octets and interface.out.octets
# We will also have two dimensions, sys.name and interface.name
# Note how this only declares WHAT we want to collect (not WHERE)
# The WHERE comes later and is configured by the user, as a monitoring configuration in Dynatrace
snmp:

  # System metrics
  - group: sys-metrics
    interval:
      minutes: 5
    dimensions:
      - key: sys.name
        value: oid:1.3.6.1.2.1.1.5.0
    
    metrics:
      - key: custom.snmp.sys.uptime
        value: oid:1.3.6.1.2.1.1.8.0
      
    # A subgroup for interface metrics
    subgroups:
      - subgroup: interface-metrics
        # Here we will loop through all interfaces, so this is a table 
        table: true
        interval:
          minutes: 1

        dimensions:
            # Note how we don't set the last OID segment (.0, .1, .2 etc), this is a table and we want all interfaces
          - key: interface.name
            value: oid:1.3.6.1.2.1.2.2.1.2
        
        metrics:
          - key: custom.snmp.interface.in.octets
            value: oid:1.3.6.1.2.1.2.2.1.10
          - key: custom.snmp.interface.out.octets
            value: oid:1.3.6.1.2.1.2.2.1.16


# Optional Metric Metadata
# This can also be edited in the Dynatrace interface 
metrics:
  - key: custom.snmp.sys.uptime
    metadata:
        unit: Second
        description: "The uptime of the system"
        displayName: "System Uptime"

  - key: custom.snmp.interface.in.octets
    metadata:
        unit: Byte
        description: "The number of bytes received on the interface"
        displayName: "Interface In Octets"

  - key: custom.snmp.interface.out.octets
    metadata:
        unit: Byte
        description: "The number of bytes sent on the interface"
        displayName: "Interface Out Octets"
        
        dimensions:
          - key: interface.name
            displayName: "Interface Name"

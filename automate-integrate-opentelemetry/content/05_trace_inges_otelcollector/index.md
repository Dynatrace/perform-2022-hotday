## Remote trace ingest using OpenTelemetry Collector

You will notice that an AWS Lambda function is called by shopizer. As we are not able to deploy the OneAgent into AWS Lambda functions, one of the ways to collect application traces is via OpenTelemetry.

In this section, the AWS Lambda function has already been auto-instrumented with OpenTelemetry, so we will use the Dynatrace remote trace ingest API to ingest the Lambda traces into Dynatrace.

### View ingested traces in Dynatrace
1. Go to Dynatrace menu -> Distributed traces -> Ingested traces (provide screen shot)
1. The `GET` traces are the entry point. Click on any one of them.
1. Expand the details and explore (provide screen shot).
1. Two things to note:
   - `service.name` - A service is created in Dynatrace if you have defined a `service.name` in the OpenTelemetry instrumentation.
   - You can click on the `trace id` to view the full distributed trace across the caller and the callee
1. Dynatrace uses the W3C trace ID to link up the traces, but the quickest way to identify the traces that is generated by your own instance of the the shopizer app is to go to `PurePaths` and select a purepath to drill down. (provide screen shot)
1. Here, you will see that the PurePaths of the `callLambda` function will expand further to reveal the OpenTelemetry traces. (provide screen shot)
1. If you select one of the click on the `trace id` to view the full distributed trace across the caller and the callee

### Quick note on OpenTelemetry Collector configuration
Your tenant is receving a lot of traces as the OpenTelemetry Collector was configured to send the trace data from a single Lambda function to multiple Dynatrace tenants. That is why you are receiving the same trace multiple times. Reference [OpenTelemetry Collector configuration](https://opentelemetry.io/docs/collector/configuration/)

```yaml
exporters:
  otlphttp/stu1:
    endpoint: "https://tenant1url/api/v2/otlp"
    headers:
      Authorization: "Api-Token dt0c01.xxx"
  otlphttp/stu2:
    endpoint: "https://tenant2url/api/v2/otlp"
    headers:
      Authorization: "Api-Token dt0c01.xxx"
...
service:
  extensions: [health_check,pprof,zpages]
  pipelines:
    traces:
      receivers: [otlp]
      processors: [batch]
      exporters: [logging,otlphttp/stu1,otlphttp/stu2]
```